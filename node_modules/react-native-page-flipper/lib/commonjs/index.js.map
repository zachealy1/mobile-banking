{"version":3,"names":["debug","logger","msg","console","log","PageFlipper","React","forwardRef","ref","data","enabled","pressable","singleImageMode","renderLastPage","portrait","onFlippedEnd","onFlipStart","onPageDrag","onPageDragEnd","onPageDragStart","onEndReached","onInitialized","renderContainer","renderPage","pageSize","height","width","contentContainerStyle","useState","setLayout","useSetState","pageIndex","pages","isAnimating","initialized","prev","left","right","current","next","nextPageIndex","undefined","isPortrait","state","setState","isAnimatingRef","useRef","prevBookPage","nextBookPage","portraitBookPage","previousPortrait","usePrevious","containerSize","useMemo","size","finalSize","ratio","diff","useEffect","initialize","allPages","createPages","adjustedIndex","getAdjustedIndex","index","error","turnPage","goToPage","useCallback","isNaN","length","previousPage","newIndex","nextPage","useImperativeHandle","Math","floor","onLayout","e","nativeEvent","layout","onPageFlipped","setIsAnimating","val","getPageStyle","front","pageStyle","position","isEvenPage","offset","isFirstPage","isLastPage","isSecondToLastPage","shouldRenderLastPage","bookPageProps","onPageFlip","single","isPressable","ContentWrapper","Wrapper","styles","container","contentContainer","content","portraitContent","StyleSheet","absoluteFillObject","zIndex","overflow","memo","props","wrap","Empty","create","flex","justifyContent","alignItems","flexDirection","backgroundColor"],"sources":["index.tsx"],"sourcesContent":["import usePrevious from './hooks/usePrevious';\nimport useSetState from './hooks/useSetState';\nimport React, { useEffect, useState, useCallback, useMemo } from 'react';\nimport { useRef } from 'react';\nimport { LayoutChangeEvent, StyleSheet, View, ViewStyle } from 'react-native';\nimport { BookPage, BookPageInstance, IBookPageProps } from './BookPage';\nimport {\n    BookPagePortrait,\n    PortraitBookInstance,\n} from './portrait/BookPagePortrait';\nimport type { Page, Size } from './types';\nimport { createPages } from './utils/utils';\nimport { BookPageBackground } from './BookPageBackground';\n\nexport type IPageFlipperProps = {\n    data: string[];\n    enabled?: boolean; // gestures\n    pressable?: boolean; // are the pages tappable\n    singleImageMode?: boolean;\n    renderLastPage?: () => React.ReactElement;\n    portrait?: boolean;\n    onFlippedEnd?: (index: number) => void;\n    onFlipStart?: (id: number) => void;\n    onPageDragStart?: () => void;\n    onPageDrag?: () => void;\n    onPageDragEnd?: () => void;\n    onEndReached?: () => void;\n    onInitialized?: (props: any) => void;\n    renderContainer?: () => any;\n    renderPage?: (data: any) => any;\n    pageSize: Size;\n    contentContainerStyle: ViewStyle;\n};\n\nexport type PageFlipperInstance = {\n    goToPage: (index: number) => void;\n    previousPage: () => void;\n    nextPage: () => void;\n};\n\nexport type State = {\n    pageIndex: number;\n    pages: Page[];\n    isAnimating: boolean;\n    initialized: boolean;\n    // pageSize: Size;\n    prev: Page;\n    current: Page;\n    next: Page;\n    nextPageIndex?: number;\n    isPortrait: boolean;\n};\n\nconst debug = true;\n\nconst logger = (msg: string) => {\n    if (debug) {\n        console.log(msg);\n    }\n};\n\nconst PageFlipper = React.forwardRef<PageFlipperInstance, IPageFlipperProps>(\n    (\n        {\n            data,\n            enabled = true,\n            pressable = true,\n            singleImageMode = true,\n            renderLastPage,\n            portrait = false,\n            onFlippedEnd,\n            onFlipStart,\n            onPageDrag,\n            onPageDragEnd,\n            onPageDragStart,\n            onEndReached,\n            onInitialized,\n            renderContainer,\n            renderPage,\n            pageSize = { height: 600, width: 400 },\n            contentContainerStyle,\n        },\n        ref\n    ) => {\n        const [{ width, height }, setLayout] = useState({\n            height: 0,\n            width: 0,\n        });\n        const [state, setState] = useSetState<State>({\n            pageIndex: 0,\n            pages: [],\n            isAnimating: false,\n            initialized: false,\n            // pageSize: { width: 0, height: 0 },\n            prev: { left: '', right: '' },\n            current: { left: '', right: '' },\n            next: { left: '', right: '' },\n            nextPageIndex: undefined,\n            isPortrait: portrait,\n        });\n        const isAnimatingRef = useRef(false);\n        const prevBookPage = useRef<BookPageInstance>(null);\n        const nextBookPage = useRef<BookPageInstance>(null);\n        const portraitBookPage = useRef<PortraitBookInstance>(null);\n        const previousPortrait = usePrevious(portrait);\n        const containerSize = useMemo(() => {\n            if (!state.initialized) {\n                return {\n                    width: 0,\n                    height: 0,\n                };\n            }\n            let size = {\n                height: pageSize.height,\n                width:\n                    singleImageMode && !state.isPortrait\n                        ? pageSize.width * 2\n                        : pageSize.width,\n            };\n\n            if (!singleImageMode && state.isPortrait) {\n                size = {\n                    height: pageSize.height,\n                    width: pageSize.width / 2,\n                };\n            }\n\n            let finalSize: Size;\n\n            // corrections\n            if (size.height > size.width) {\n                const ratio = size.height / size.width;\n                finalSize = {\n                    height: width * ratio,\n                    width,\n                };\n\n                if (finalSize.height > height) {\n                    const diff = finalSize.height / height;\n                    finalSize.height = height;\n                    finalSize.width = finalSize.width / diff;\n                }\n            } else {\n                const ratio = size.width / size.height;\n                finalSize = {\n                    height,\n                    width: height * ratio,\n                };\n                if (finalSize.width > width) {\n                    const diff = finalSize.width / width;\n                    finalSize.width = width;\n                    finalSize.height = finalSize.height / diff;\n                }\n            }\n\n            return finalSize;\n        }, [\n            height,\n            singleImageMode,\n            width,\n            state.initialized,\n            state.isPortrait,\n            pageSize.height,\n            pageSize.width,\n        ]);\n\n        useEffect(() => {\n            const initialize = async () => {\n                try {\n                    const allPages = createPages({\n                        portrait,\n                        singleImageMode,\n                        data,\n                    });\n\n                    let adjustedIndex = getAdjustedIndex(allPages);\n\n                    setState({\n                        initialized: true,\n                        pages: allPages,\n                        prev: allPages[adjustedIndex - 1],\n                        current: allPages[adjustedIndex],\n                        next: allPages[adjustedIndex + 1],\n                        pageIndex: adjustedIndex,\n                        isPortrait: portrait,\n                    });\n\n                    if (onInitialized) {\n                        onInitialized({\n                            pages: allPages,\n                            index: adjustedIndex,\n                        });\n                    }\n                } catch (error) {\n                    console.error('error', error);\n                }\n            };\n            initialize();\n            // eslint-disable-next-line\n        }, [data, portrait, singleImageMode]);\n\n        useEffect(() => {\n            if (state.nextPageIndex !== undefined) {\n                if (!state.isPortrait) {\n                    if (state.nextPageIndex > state.pageIndex) {\n                        nextBookPage.current?.turnPage();\n                    } else {\n                        prevBookPage.current?.turnPage();\n                    }\n                } else {\n                    portraitBookPage.current?.turnPage(\n                        state.nextPageIndex > state.pageIndex ? 1 : -1\n                    );\n                }\n            }\n            // eslint-disable-next-line\n        }, [state.nextPageIndex]);\n\n        const goToPage = useCallback(\n            (index: number) => {\n                if (index === undefined || index === null) {\n                    logger('index cannot be undefined or null');\n                    return;\n                }\n\n                if (typeof index !== 'number' || isNaN(index)) {\n                    logger('index must be a number');\n                    return;\n                }\n\n                if (index < 0 || index > state.pages.length - 1) {\n                    logger('invalid page');\n                    return;\n                }\n\n                if (isAnimatingRef.current) {\n                    logger('is already animating');\n                    return;\n                }\n\n                if (index === state.pageIndex) {\n                    logger('same page');\n                    return;\n                }\n\n                if (index > state.pageIndex) {\n                    setState({\n                        next: state.pages[index],\n                        nextPageIndex: index,\n                    });\n                } else {\n                    setState({\n                        prev: state.pages[index],\n                        nextPageIndex: index,\n                    });\n                }\n            },\n            [setState, state.pageIndex, state.pages]\n        );\n\n        const previousPage = useCallback(() => {\n            const newIndex = state.pageIndex - 1;\n            goToPage(newIndex);\n        }, [goToPage, state.pageIndex]);\n\n        const nextPage = useCallback(() => {\n            const newIndex = state.pageIndex + 1;\n            goToPage(newIndex);\n        }, [goToPage, state.pageIndex]);\n\n        React.useImperativeHandle(\n            ref,\n            () => ({\n                goToPage,\n                nextPage,\n                previousPage,\n            }),\n            [goToPage, nextPage, previousPage]\n        );\n\n        const getAdjustedIndex = (allPages: any[]) => {\n            // THIS NEEDS REWORKING\n            let adjustedIndex = state.pageIndex;\n            if (\n                previousPortrait !== undefined &&\n                previousPortrait !== portrait &&\n                singleImageMode\n            ) {\n                if (portrait) {\n                    adjustedIndex *= 2;\n                } else {\n                    adjustedIndex = Math.floor(\n                        adjustedIndex % 2 === 0\n                            ? adjustedIndex / 2\n                            : (adjustedIndex - 1) / 2\n                    );\n                }\n            }\n\n            if (adjustedIndex < 0 || adjustedIndex > allPages.length - 1) {\n                // invalid index, reset to 0\n                adjustedIndex = 0;\n            }\n            return adjustedIndex;\n        };\n\n        const onLayout = (e: LayoutChangeEvent) => {\n            setLayout({\n                height: e.nativeEvent.layout.height,\n                width: e.nativeEvent.layout.width,\n            });\n        };\n\n        const onPageFlipped = useCallback(\n            (index: number) => {\n                const newIndex =\n                    state.nextPageIndex !== undefined\n                        ? state.nextPageIndex\n                        : state.pageIndex + index;\n\n                if (newIndex < 0 || newIndex > state.pages.length - 1) {\n                    // this if condition theoretically should never occur in the first place, so it could be removed but it's here just in case\n                    logger('invalid page');\n\n                    setState({\n                        isAnimating: false,\n                        nextPageIndex: undefined,\n                    });\n                    isAnimatingRef.current = false;\n                    return;\n                }\n\n                const prev = state.pages[newIndex - 1];\n                const current = state.pages[newIndex];\n                const next = state.pages[newIndex + 1];\n                setState({\n                    pageIndex: newIndex,\n                    isAnimating: false,\n                    prev,\n                    current,\n                    next,\n                    nextPageIndex: undefined,\n                });\n                isAnimatingRef.current = false;\n                if (onFlippedEnd && typeof onFlippedEnd === 'function') {\n                    onFlippedEnd(newIndex);\n                }\n\n                if (newIndex === state.pages.length - 1 && onEndReached) {\n                    onEndReached();\n                }\n            },\n            [\n                onEndReached,\n                onFlippedEnd,\n                setState,\n                state.nextPageIndex,\n                state.pageIndex,\n                state.pages,\n            ]\n        );\n\n        const setIsAnimating = useCallback(\n            (val: boolean) => {\n                setState({\n                    isAnimating: val,\n                });\n                isAnimatingRef.current = val;\n            },\n            [setState]\n        );\n\n        const getPageStyle = (right: boolean, front: boolean) => {\n            if (!singleImageMode && isPortrait) {\n                const pageStyle: any = {\n                    height: containerSize.height,\n                    width: containerSize.width * 2,\n                    position: 'absolute',\n                };\n\n                const isEvenPage = pageIndex % 2 === 0;\n\n                if (front) {\n                    if (isEvenPage) {\n                        pageStyle.left = right ? 0 : -containerSize.width;\n                    } else {\n                        pageStyle.left = right ? -containerSize.width : 0;\n                    }\n                } else {\n                    if (isEvenPage) {\n                        pageStyle.left = right ? -containerSize.width : 0;\n                    } else {\n                        pageStyle.left = right ? 0 : -containerSize.width;\n                    }\n                }\n                return pageStyle;\n            }\n\n            const pageStyle: any = {\n                height: containerSize.height,\n                width:\n                    singleImageMode && !isPortrait\n                        ? containerSize.width / 2\n                        : containerSize.width,\n                position: 'absolute',\n            };\n\n            const offset = singleImageMode ? 0 : -containerSize.width / 2;\n\n            if (isPortrait && front) {\n                pageStyle.left = 0;\n            } else if ((front && right) || (!front && right)) {\n                // front right or back right\n                pageStyle.left = offset;\n            } else if (front && !right) {\n                // front left\n                pageStyle.right = offset;\n            }\n\n            return pageStyle;\n        };\n\n        if (!state.initialized) {\n            return null;\n        }\n\n        const {\n            current,\n            pageIndex,\n            pages,\n            next,\n            prev,\n            isPortrait,\n            isAnimating,\n        } = state;\n        const isFirstPage = pageIndex === 0;\n        const isLastPage = pageIndex === pages.length - 1;\n        const isSecondToLastPage = pageIndex === pages.length - 2;\n        const shouldRenderLastPage =\n            (isSecondToLastPage || isLastPage) &&\n            singleImageMode &&\n            data.length % 2 !== 0;\n\n        const bookPageProps: Omit<IBookPageProps, 'right' | 'front' | 'back'> =\n            {\n                containerSize: containerSize,\n                isAnimating: isAnimating,\n                enabled,\n                setIsAnimating: setIsAnimating,\n                isAnimatingRef: isAnimatingRef,\n                onPageFlip: onPageFlipped,\n                getPageStyle,\n                single: singleImageMode,\n                onFlipStart,\n                onPageDrag,\n                onPageDragEnd,\n                onPageDragStart,\n                isPressable: pressable,\n                renderPage,\n            };\n\n        const ContentWrapper = renderContainer ? renderContainer : Wrapper;\n\n        return (\n            <View style={styles.container} onLayout={onLayout}>\n                <View\n                    style={[\n                        styles.contentContainer,\n                        {\n                            height: containerSize.height,\n                            width: containerSize.width,\n                        },\n                        contentContainerStyle,\n                    ]}\n                >\n                    <ContentWrapper>\n                        {!isPortrait ? (\n                            <View style={styles.content}>\n                                {!prev ? (\n                                    <Empty />\n                                ) : (\n                                    <BookPage\n                                        ref={prevBookPage}\n                                        right={false}\n                                        front={current}\n                                        back={prev}\n                                        key={`left${pageIndex}`}\n                                        {...bookPageProps}\n                                    />\n                                )}\n                                {!next ? (\n                                    <Empty />\n                                ) : (\n                                    <BookPage\n                                        ref={nextBookPage}\n                                        right\n                                        front={current}\n                                        back={next}\n                                        key={`right${pageIndex}`}\n                                        {...bookPageProps}\n                                    />\n                                )}\n                                <BookPageBackground\n                                    left={!prev ? current.left : prev.left}\n                                    right={!next ? current.right : next.right}\n                                    isFirstPage={isFirstPage}\n                                    isLastPage={isLastPage}\n                                    getPageStyle={getPageStyle}\n                                    containerSize={containerSize}\n                                    renderPage={renderPage}\n                                    renderLastPage={renderLastPage}\n                                    shouldRenderLastPage={shouldRenderLastPage}\n                                />\n                            </View>\n                        ) : (\n                            <View style={styles.portraitContent}>\n                                <View\n                                    style={{ ...StyleSheet.absoluteFillObject }}\n                                >\n                                    <BookPagePortrait\n                                        {...bookPageProps}\n                                        current={current}\n                                        prev={prev}\n                                        next={next}\n                                        onPageFlip={onPageFlipped}\n                                        key={`right${pageIndex}`}\n                                        ref={portraitBookPage}\n                                    />\n                                </View>\n                                {next && (\n                                    <View\n                                        style={{\n                                            ...StyleSheet.absoluteFillObject,\n                                            zIndex: -5,\n                                            overflow: 'hidden',\n                                        }}\n                                    >\n                                        {renderPage && (\n                                            <View\n                                                style={getPageStyle(\n                                                    true,\n                                                    false\n                                                )}\n                                            >\n                                                {renderPage(next.right)}\n                                            </View>\n                                        )}\n                                    </View>\n                                )}\n                            </View>\n                        )}\n                    </ContentWrapper>\n                </View>\n            </View>\n        );\n    }\n);\n\nexport default React.memo(PageFlipper);\n\nconst Wrapper = (props: any) => <View style={styles.wrap} {...props} />;\n\nconst Empty = () => <View style={styles.container} pointerEvents=\"none\" />;\n\nconst styles = StyleSheet.create({\n    container: {\n        flex: 1,\n        justifyContent: 'center',\n        alignItems: 'center',\n    },\n    wrap: {\n        flex: 1,\n    },\n    contentContainer: {\n        flexDirection: 'row',\n        // shadowColor: '#000',\n        // shadowOffset: {\n        //     width: 0,\n        //     height: 2,\n        // },\n        // shadowOpacity: 0.25,\n        // shadowRadius: 3.84,\n        // elevation: 5,\n        backgroundColor: 'white',\n    },\n    content: {\n        flex: 1,\n        flexDirection: 'row',\n        overflow: 'hidden',\n    },\n    portraitContent: {\n        flex: 1,\n        overflow: 'hidden',\n    },\n});\n"],"mappings":"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"}