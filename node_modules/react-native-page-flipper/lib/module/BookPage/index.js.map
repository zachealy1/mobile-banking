{"version":3,"names":["React","useCallback","useEffect","useRef","useState","Pressable","StyleSheet","View","PanGestureHandler","Animated","Easing","Extrapolate","interpolate","runOnJS","useAnimatedGestureHandler","useAnimatedStyle","useSharedValue","withTiming","BackShadow","FrontShadow","PageShadow","BookSpine","BookSpine2","clamp","snapPoint","timingConfig","duration","easing","inOut","cubic","BookPage","forwardRef","ref","right","front","back","onPageFlip","containerSize","isAnimatingRef","setIsAnimating","isAnimating","enabled","isPressable","getPageStyle","single","onFlipStart","onPageDrag","onPageDragEnd","onPageDragStart","renderPage","x","isMounted","rotateYAsDeg","isDragging","setIsDragging","isDraggingRef","containerWidth","width","containerHeight","height","leftPSnapPoints","rightPSnapPoints","pSnapPoints","gesturesEnabled","showSpine","current","turnPage","id","value","useImperativeHandle","onDrag","val","backStyle","degrees","w","Math","ceil","zIndex","transform","translateX","frontStyle","CLAMP","style","floor","containerStyle","flex","animatedBackPageStyle","l","left","onPanGestureHandler","onStart","event","ctx","onActive","translationX","onEnd","snapTo","velocityX","progress","abs","frontPageStyle","backPageStyle","frontUrl","backUrl","position","styles","pageContainer","overflow","viewHeight","BlankPage","absoluteFillObject","backgroundColor","create","container","backfaceVisibility"],"sources":["index.tsx"],"sourcesContent":["import React, { useCallback, useEffect, useRef, useState } from 'react';\nimport { Pressable, StyleSheet, View, ViewStyle } from 'react-native';\nimport {\n    PanGestureHandler,\n    PanGestureHandlerGestureEvent,\n} from 'react-native-gesture-handler';\nimport Animated, {\n    Easing,\n    Extrapolate,\n    interpolate,\n    runOnJS,\n    useAnimatedGestureHandler,\n    useAnimatedStyle,\n    useSharedValue,\n    withTiming,\n    WithTimingConfig,\n} from 'react-native-reanimated';\nimport type { Page, Size } from '../types';\nimport BackShadow from './BackShadow';\nimport FrontShadow from './FrontShadow';\nimport PageShadow from './PageShadow';\nimport { BookSpine } from './BookSpine';\nimport { BookSpine2 } from './BookSpine2';\nimport { clamp, snapPoint } from '../utils/utils';\nexport type IBookPageProps = {\n    right: boolean;\n    front: Page;\n    back: Page;\n    onPageFlip: any;\n    containerSize: Size;\n    isAnimatingRef: React.MutableRefObject<boolean>;\n    setIsAnimating: (val: boolean) => void;\n    isAnimating: boolean;\n    enabled: boolean;\n    isPressable: boolean;\n    getPageStyle: (right: boolean, front: boolean) => any;\n    single: boolean;\n    onFlipStart?: (id: number) => void;\n    onPageDragStart?: () => void;\n    onPageDrag?: () => void;\n    onPageDragEnd?: () => void;\n    renderPage?: (data: any) => any;\n};\n\nexport type BookPageInstance = {\n    turnPage: () => void;\n};\n\nconst timingConfig: WithTimingConfig = {\n    duration: 800,\n    easing: Easing.inOut(Easing.cubic),\n};\n\nconst BookPage = React.forwardRef<BookPageInstance, IBookPageProps>(\n    (\n        {\n            right,\n            front,\n            back,\n            onPageFlip,\n            containerSize,\n            isAnimatingRef,\n            setIsAnimating,\n            isAnimating,\n            enabled,\n            isPressable,\n            getPageStyle,\n            single,\n            onFlipStart,\n            onPageDrag,\n            onPageDragEnd,\n            onPageDragStart,\n            renderPage,\n        },\n        ref\n    ) => {\n        const x = useSharedValue(0);\n        const isMounted = useRef(false);\n        const rotateYAsDeg = useSharedValue(0);\n        const [isDragging, setIsDragging] = useState(false);\n        const isDraggingRef = useRef(false);\n        const containerWidth = containerSize.width;\n        const containerHeight = containerSize.height;\n        const leftPSnapPoints = [0, containerWidth];\n        const rightPSnapPoints = [-containerWidth, 0];\n        const pSnapPoints = right ? rightPSnapPoints : leftPSnapPoints;\n        const gesturesEnabled = enabled && !isAnimating;\n        const showSpine = true;\n\n        // might not need this useEffect\n        // useEffect(() => {\n        //   if (!enabled) {\n        //     setIsDragging(false);\n        //   }\n        // }, [enabled]);\n\n        useEffect(() => {\n            isMounted.current = true;\n            return () => {\n                isMounted.current = false;\n            };\n        }, []);\n\n        const turnPage = useCallback(() => {\n            setIsDragging(true);\n            setIsAnimating(true);\n            const id = right ? 1 : -1;\n\n            if (onFlipStart && typeof onFlipStart === 'function') {\n                onFlipStart(id);\n            }\n            rotateYAsDeg.value = withTiming(\n                right ? 180 : -180,\n                timingConfig,\n                () => {\n                    runOnJS(onPageFlip)(id, false);\n                }\n            );\n        }, [\n            onFlipStart,\n            setIsDragging,\n            right,\n            onPageFlip,\n            rotateYAsDeg,\n            setIsAnimating,\n        ]);\n\n        React.useImperativeHandle(\n            ref,\n            () => ({\n                turnPage,\n            }),\n            [turnPage]\n        );\n\n        const onDrag = useCallback((val: boolean) => {\n            if (!isMounted.current) {\n                return;\n            }\n\n            if (isDraggingRef.current === val) {\n                // same value\n                return;\n            }\n\n            setIsDragging(val);\n            isDraggingRef.current = val;\n        }, []);\n\n        const backStyle = useAnimatedStyle(() => {\n            const degrees = rotateYAsDeg.value;\n            const x = right\n                ? interpolate(\n                      degrees,\n                      [0, 180],\n                      [containerWidth / 2, -containerWidth / 2]\n                  )\n                : interpolate(degrees, [-180, 0], [containerWidth / 2, 0]);\n\n            const w = right\n                ? interpolate(degrees, [0, 180], [0, containerWidth / 2])\n                : interpolate(degrees, [-180, 0], [containerWidth / 2, 0]);\n            return {\n                width: Math.ceil(w),\n                zIndex: 2,\n                transform: [{ translateX: x }],\n            };\n        });\n\n        const frontStyle = useAnimatedStyle(() => {\n            const degrees = rotateYAsDeg.value;\n\n            const w = right\n                ? interpolate(\n                      degrees,\n                      [0, 90],\n                      [containerWidth / 2, 0],\n                      Extrapolate.CLAMP\n                  )\n                : interpolate(\n                      degrees,\n                      [-90, 0],\n                      [0, containerWidth / 2],\n                      Extrapolate.CLAMP\n                  );\n\n            const style: ViewStyle = {\n                zIndex: 1,\n                width: Math.floor(w),\n            };\n\n            if (right) {\n                style['left'] = 0;\n            } else {\n                style['right'] = 0;\n            }\n\n            return style;\n        });\n\n        const containerStyle = useAnimatedStyle(() => {\n            return {\n                flex: 1,\n                // backgroundColor: 'white',\n                zIndex: isDragging ? 100 : 0,\n            };\n        });\n\n        const animatedBackPageStyle = useAnimatedStyle(() => {\n            const l = right\n                ? 0\n                : interpolate(\n                      rotateYAsDeg.value,\n                      [-180, 0],\n                      single\n                          ? [0, -containerWidth / 2]\n                          : [-containerWidth / 2, -containerWidth]\n                  );\n\n            return {\n                left: l,\n            };\n        });\n\n        const onPanGestureHandler = useAnimatedGestureHandler<\n            PanGestureHandlerGestureEvent,\n            { x: number }\n        >({\n            // @ts-ignore\n            onStart: (event, ctx) => {\n                if (onPageDragStart && typeof onPageDragStart === 'function') {\n                    runOnJS(onPageDragStart)();\n                }\n                ctx.x = x.value;\n            },\n            onActive: (event, ctx) => {\n                runOnJS(onDrag)(true);\n                x.value = ctx.x + event.translationX;\n                rotateYAsDeg.value = interpolate(\n                    x.value,\n                    [-containerWidth, 0, containerWidth],\n                    [180, 0, -180],\n                    Extrapolate.CLAMP\n                );\n\n                if (onPageDrag && typeof onPageDrag === 'function') {\n                    runOnJS(onPageDrag)();\n                }\n            },\n            onEnd: (event) => {\n                if (onPageDragEnd && typeof onPageDragEnd === 'function') {\n                    runOnJS(onPageDragEnd)();\n                }\n\n                const snapTo = snapPoint(x.value, event.velocityX, pSnapPoints);\n                const id = snapTo > 0 ? -1 : snapTo < 0 ? 1 : 0;\n                const degrees = snapTo > 0 ? -180 : snapTo < 0 ? 180 : 0;\n                x.value = snapTo;\n\n                if (rotateYAsDeg.value === degrees) {\n                    runOnJS(onPageFlip)(id, false);\n                } else {\n                    runOnJS(setIsAnimating)(true);\n\n                    const progress =\n                        Math.abs(rotateYAsDeg.value - degrees) / 100;\n                    const duration = clamp(\n                        800 * progress - Math.abs(0.1 * event.velocityX),\n                        350,\n                        1000\n                    );\n\n                    rotateYAsDeg.value = withTiming(\n                        degrees,\n                        {\n                            ...timingConfig,\n                            duration: duration,\n                        },\n                        () => {\n                            if (snapTo === 0) {\n                                runOnJS(onDrag)(false);\n                            }\n                            runOnJS(onPageFlip)(id, false);\n                        }\n                    );\n                }\n            },\n        });\n\n        if (!front || !back) {\n            return null;\n        }\n\n        const frontPageStyle = getPageStyle(right, true);\n        const backPageStyle = getPageStyle(right, false);\n\n        const frontUrl = right ? front.right : front.left;\n        const backUrl = right ? back.left : back.right;\n        return (\n            <PanGestureHandler\n                onGestureEvent={onPanGestureHandler}\n                enabled={gesturesEnabled}\n            >\n                <Animated.View style={containerStyle}>\n                    {isPressable && (\n                        <Pressable\n                            disabled={isAnimating}\n                            onPress={() => {\n                                if (!isAnimatingRef.current) turnPage();\n                            }}\n                            style={[\n                                {\n                                    position: 'absolute',\n                                    height: '100%',\n                                    width: '25%',\n                                    zIndex: 10000,\n                                },\n                                right ? { right: 0 } : { left: 0 },\n                            ]}\n                        />\n                    )}\n\n                    {/* BACK */}\n                    <Animated.View\n                        style={[\n                            styles.pageContainer,\n                            backStyle,\n                            { overflow: 'visible' },\n                        ]}\n                    >\n                        <View style={styles.pageContainer}>\n                            {backUrl ? (\n                                renderPage && (\n                                    <Animated.View\n                                        style={[\n                                            backPageStyle,\n                                            animatedBackPageStyle,\n                                        ]}\n                                    >\n                                        {renderPage(backUrl)}\n                                    </Animated.View>\n                                )\n                            ) : (\n                                <BlankPage />\n                            )}\n                        </View>\n\n                        <BackShadow {...{ degrees: rotateYAsDeg, right }} />\n                        <FrontShadow\n                            {...{\n                                right,\n                                degrees: rotateYAsDeg,\n                                width: containerWidth,\n                                viewHeight: containerHeight,\n                            }}\n                        />\n\n                        <PageShadow\n                            {...{\n                                right,\n                                degrees: rotateYAsDeg,\n                                width: containerWidth,\n                                viewHeight: containerHeight,\n                                containerSize,\n                            }}\n                        />\n\n                        {showSpine && (\n                            <BookSpine2\n                                right={right}\n                                degrees={rotateYAsDeg}\n                                containerSize={containerSize}\n                            />\n                        )}\n                    </Animated.View>\n                    {/* FRONT */}\n                    <Animated.View style={[styles.pageContainer, frontStyle]}>\n                        {frontUrl ? (\n                            renderPage && (\n                                <Animated.View style={[frontPageStyle]}>\n                                    {renderPage(frontUrl)}\n                                </Animated.View>\n                            )\n                        ) : (\n                            <BlankPage />\n                        )}\n                        {showSpine && (\n                            <BookSpine\n                                right={right}\n                                containerSize={containerSize}\n                            />\n                        )}\n                    </Animated.View>\n                </Animated.View>\n            </PanGestureHandler>\n        );\n    }\n);\n\nexport { BookPage };\n\nconst BlankPage = () => (\n    <View\n        style={{ ...StyleSheet.absoluteFillObject, backgroundColor: '#fff' }}\n    />\n);\n\nconst styles = StyleSheet.create({\n    container: {\n        flex: 1,\n    },\n    pageContainer: {\n        height: '100%',\n        width: '100%',\n        position: 'absolute',\n        backfaceVisibility: 'hidden',\n        overflow: 'hidden',\n        // justifyContent: 'center',\n        // alignItems: 'flex-end',\n        // backgroundColor: 'rgba(0,0,0,0)',\n        // backgroundColor: 'white',\n    },\n});\n"],"mappings":"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"}