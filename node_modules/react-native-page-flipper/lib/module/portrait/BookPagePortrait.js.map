{"version":3,"names":["React","useCallback","useEffect","useRef","useState","Pressable","StyleSheet","View","PanGestureHandler","Animated","Easing","Extrapolate","interpolate","runOnJS","useAnimatedGestureHandler","useAnimatedStyle","useDerivedValue","useSharedValue","withTiming","BackShadow","FrontShadow","PageShadow","clamp","snapPoint","timingConfig","duration","easing","inOut","cubic","BookPagePortrait","forwardRef","ref","current","prev","onPageFlip","containerSize","enabled","isPressable","setIsAnimating","getPageStyle","isAnimating","isAnimatingRef","next","onFlipStart","onPageDrag","onPageDragEnd","onPageDragStart","renderPage","containerWidth","width","pSnapPoints","x","isMounted","rotateYAsDeg","turnPage","id","value","useImperativeHandle","getDegreesForX","val","CLAMP","containerStyle","flex","onPanGestureHandler","onStart","event","ctx","onActive","newX","translationX","degrees","onEnd","snapTo","velocityX","progress","Math","abs","gesturesEnabled","iPageProps","position","height","zIndex","left","right","IPage","page","loaded","setLoaded","setTimeout","rotationVal","portraitBackStyle","w","ceil","opacity","transform","translateX","portraitFrontStyle","style","floor","frontPageStyle","backPageStyle","shadowProps","viewHeight","absoluteFillObject","styles","pageContainer","overflow","rotateX","rotateZ","create","container","backfaceVisibility","backgroundColor"],"sources":["BookPagePortrait.tsx"],"sourcesContent":["import React, { useCallback, useEffect, useRef, useState } from 'react';\nimport { Pressable, StyleSheet, View, ViewStyle } from 'react-native';\nimport {\n    PanGestureHandler,\n    PanGestureHandlerGestureEvent,\n} from 'react-native-gesture-handler';\nimport Animated, {\n    Easing,\n    Extrapolate,\n    interpolate,\n    runOnJS,\n    useAnimatedGestureHandler,\n    useAnimatedStyle,\n    useDerivedValue,\n    useSharedValue,\n    withTiming,\n    WithTimingConfig,\n} from 'react-native-reanimated';\nimport type { Page, Size } from '../types';\nimport BackShadow from '../BookPage/BackShadow';\nimport FrontShadow from '../BookPage/FrontShadow';\nimport PageShadow from '../BookPage/PageShadow';\nimport { clamp, snapPoint } from '../utils/utils';\n\nexport type IBookPageProps = {\n    current: Page;\n    prev: Page;\n    onPageFlip: any;\n    containerSize: Size;\n    setIsAnimating: (val: boolean) => void;\n    isAnimating: boolean;\n    enabled: boolean;\n    isPressable: boolean;\n    getPageStyle: (right: boolean, front: boolean) => any;\n    isAnimatingRef: React.MutableRefObject<boolean>;\n    next: Page;\n    onFlipStart?: (id: number) => void;\n    onPageDragStart?: () => void;\n    onPageDrag?: () => void;\n    onPageDragEnd?: () => void;\n    renderPage?: (data: any) => any;\n};\n\nexport type PortraitBookInstance = { turnPage: (index: 1 | -1) => void };\n\nconst timingConfig: WithTimingConfig = {\n    duration: 800,\n    easing: Easing.inOut(Easing.cubic),\n};\n\nconst BookPagePortrait = React.forwardRef<PortraitBookInstance, IBookPageProps>(\n    (\n        {\n            current,\n            prev,\n            onPageFlip,\n            containerSize,\n            enabled,\n            isPressable,\n            setIsAnimating,\n            getPageStyle,\n            isAnimating,\n            isAnimatingRef,\n            next,\n            onFlipStart,\n            onPageDrag,\n            onPageDragEnd,\n            onPageDragStart,\n            renderPage,\n        },\n        ref\n    ) => {\n        const containerWidth = containerSize.width;\n\n        const pSnapPoints = !prev\n            ? [-containerSize.width, 0]\n            : [-containerSize.width, 0, containerSize.width];\n\n        const x = useSharedValue(0);\n\n        const isMounted = useRef(false);\n        const rotateYAsDeg = useSharedValue(0);\n\n        // might not need this\n        // useEffect(() => {\n        //   if (!enabled) {\n        //     setIsDragging(false);\n        //   }\n        // }, [enabled]);\n\n        const turnPage = useCallback(\n            (id: 1 | -1) => {\n                setIsAnimating(true);\n                if (onFlipStart && typeof onFlipStart === 'function') {\n                    onFlipStart(id);\n                }\n                rotateYAsDeg.value = withTiming(\n                    id < 0 ? -180 : 180,\n                    timingConfig,\n                    () => {\n                        runOnJS(onPageFlip)(id, false);\n                    }\n                );\n            },\n            [onFlipStart, onPageFlip, rotateYAsDeg, setIsAnimating]\n        );\n\n        React.useImperativeHandle(\n            ref,\n            () => ({\n                turnPage,\n            }),\n            [turnPage]\n        );\n\n        useEffect(() => {\n            isMounted.current = true;\n            return () => {\n                isMounted.current = false;\n            };\n        }, []);\n\n        const getDegreesForX = (x: number) => {\n            'worklet';\n\n            const val = interpolate(\n                x,\n                [-containerSize.width, 0, containerSize.width],\n                [180, 0, -180],\n                Extrapolate.CLAMP\n            );\n            return val;\n        };\n\n        const containerStyle = useAnimatedStyle(() => {\n            return {\n                flex: 1,\n            };\n        });\n\n        const onPanGestureHandler = useAnimatedGestureHandler<\n            PanGestureHandlerGestureEvent,\n            { x: number }\n        >({\n            // @ts-ignore\n            onStart: (event, ctx) => {\n                ctx.x = x.value;\n                if (onPageDragStart && typeof onPageDragStart === 'function') {\n                    runOnJS(onPageDragStart)();\n                }\n            },\n            onActive: (event, ctx) => {\n                const newX = ctx.x + event.translationX;\n                const degrees = getDegreesForX(newX);\n                x.value = newX;\n                rotateYAsDeg.value = degrees;\n                if (onPageDrag && typeof onPageDrag === 'function') {\n                    runOnJS(onPageDrag)();\n                }\n            },\n            onEnd: (event) => {\n                if (onPageDragEnd && typeof onPageDragEnd === 'function') {\n                    runOnJS(onPageDragEnd)();\n                }\n\n                const snapTo = snapPoint(x.value, event.velocityX, pSnapPoints);\n                const id = snapTo > 0 ? -1 : snapTo < 0 ? 1 : 0;\n\n                if (!next && id > 0) {\n                    // reset\n                    x.value = withTiming(0);\n                    rotateYAsDeg.value = withTiming(0);\n                    // runOnJS(onDrag)(false);\n                    return;\n                }\n\n                const degrees = getDegreesForX(snapTo);\n                x.value = snapTo;\n                if (rotateYAsDeg.value === degrees) {\n                    // already same value\n                    // debugValue('already there');\n                    runOnJS(onPageFlip)(id, false);\n                } else {\n                    runOnJS(setIsAnimating)(true);\n\n                    const progress =\n                        Math.abs(rotateYAsDeg.value - degrees) / 100;\n                    const duration = clamp(\n                        800 * progress - Math.abs(0.1 * event.velocityX),\n                        350,\n                        1000\n                    );\n                    rotateYAsDeg.value = withTiming(\n                        degrees,\n                        {\n                            ...timingConfig,\n                            duration: duration,\n                        },\n                        () => {\n                            if (snapTo === 0) {\n                                //\n                            }\n                            runOnJS(onPageFlip)(id, false);\n                        }\n                    );\n                }\n            },\n        });\n\n        const gesturesEnabled = enabled && !isAnimating;\n\n        const iPageProps = {\n            containerSize,\n            containerWidth,\n            getPageStyle,\n            rotateYAsDeg,\n            renderPage,\n        };\n\n        return (\n            <Animated.View style={containerStyle}>\n                <PanGestureHandler\n                    onGestureEvent={onPanGestureHandler}\n                    enabled={gesturesEnabled}\n                >\n                    <Animated.View style={containerStyle}>\n                        {isPressable && prev && (\n                            <Pressable\n                                disabled={isAnimating}\n                                onPress={() => {\n                                    if (!isAnimatingRef.current) turnPage(-1);\n                                }}\n                                style={{\n                                    position: 'absolute',\n                                    height: '100%',\n                                    width: '25%',\n                                    zIndex: 10000,\n                                    left: 0,\n                                    // backgroundColor: 'red',\n                                    // opacity: 0.2,\n                                }}\n                            />\n                        )}\n                        {isPressable && next && (\n                            <Pressable\n                                disabled={isAnimating}\n                                onPress={() => {\n                                    if (!isAnimatingRef.current) turnPage(1);\n                                }}\n                                style={{\n                                    position: 'absolute',\n                                    height: '100%',\n                                    width: '30%',\n                                    zIndex: 10000,\n                                    right: 0,\n                                    // backgroundColor: 'blue',\n                                    // opacity: 0.2,\n                                }}\n                            />\n                        )}\n                        {current && next ? (\n                            <IPage\n                                page={current}\n                                right={true}\n                                {...iPageProps}\n                            />\n                        ) : (\n                            <View style={{ height: '100%', width: '100%' }}>\n                                {renderPage && (\n                                    <View style={getPageStyle(true, true)}>\n                                        {renderPage(current.right)}\n                                    </View>\n                                )}\n                            </View>\n                        )}\n                        {prev && (\n                            <IPage page={prev} right={false} {...iPageProps} />\n                        )}\n                    </Animated.View>\n                </PanGestureHandler>\n            </Animated.View>\n        );\n    }\n);\n\ntype IPageProps = {\n    right: boolean;\n    page: Page;\n    rotateYAsDeg: Animated.SharedValue<number>;\n    containerWidth: number;\n    containerSize: Size;\n    getPageStyle: any;\n    renderPage?: (data: any) => any;\n};\n\nconst IPage: React.FC<IPageProps> = ({\n    right,\n    page,\n    rotateYAsDeg,\n    containerWidth,\n    containerSize,\n    getPageStyle,\n    renderPage,\n}) => {\n    const [loaded, setLoaded] = useState(right);\n\n    useEffect(() => {\n        // hack fix\n        setTimeout(() => {\n            setLoaded(true);\n        }, 50);\n    }, []);\n\n    const rotationVal = useDerivedValue(() => {\n        const val = right\n            ? rotateYAsDeg.value\n            : interpolate(rotateYAsDeg.value, [-180, 0], [0, 180]);\n        return val;\n    });\n\n    const portraitBackStyle = useAnimatedStyle(() => {\n        const x = interpolate(\n            rotationVal.value,\n            [0, 180],\n            [containerWidth, -containerWidth / 2]\n        );\n        const w = interpolate(\n            rotationVal.value,\n            [0, 180],\n            [0, containerWidth / 2]\n        );\n\n        return {\n            width: Math.ceil(w),\n            zIndex: 2,\n            opacity: 1,\n            transform: [{ translateX: x }],\n        };\n    });\n\n    const portraitFrontStyle = useAnimatedStyle(() => {\n        const w = interpolate(\n            rotationVal.value,\n            [0, 160],\n            [containerWidth, -20],\n            Extrapolate.CLAMP\n        );\n\n        const style: ViewStyle = {\n            zIndex: 1,\n            width: Math.floor(w),\n        };\n\n        if (!right) {\n            style['left'] = 0;\n        } else {\n            // style['right'] = 0;\n        }\n\n        return style;\n    });\n\n    const frontPageStyle = getPageStyle(right, true);\n    const backPageStyle = getPageStyle(right, false);\n\n    if (!loaded) {\n        // hack fix\n        return null;\n    }\n\n    const shadowProps = {\n        right: true,\n        degrees: rotationVal,\n        width: containerSize.width,\n        viewHeight: containerSize.height,\n    };\n\n    return (\n        <View\n            style={{\n                ...StyleSheet.absoluteFillObject,\n                zIndex: !right ? 5 : 0,\n            }}\n        >\n            {/* BACK */}\n            <Animated.View\n                style={[\n                    styles.pageContainer,\n                    portraitBackStyle,\n                    { overflow: 'visible' },\n                ]}\n            >\n                <View style={styles.pageContainer}>\n                    {renderPage && (\n                        <Animated.View\n                            style={[\n                                backPageStyle,\n\n                                {\n                                    opacity: 0.2,\n                                    transform: [\n                                        { rotateX: '180deg' },\n                                        { rotateZ: '180deg' },\n                                    ],\n                                },\n                            ]}\n                        >\n                            {renderPage(page.left)}\n                        </Animated.View>\n                    )}\n                </View>\n                <BackShadow {...{ degrees: rotationVal, right: true }} />\n                <FrontShadow {...shadowProps} />\n                <PageShadow {...shadowProps} containerSize={containerSize} />\n            </Animated.View>\n            {/* FRONT */}\n            <Animated.View style={[styles.pageContainer, portraitFrontStyle]}>\n                {renderPage && (\n                    <Animated.View style={[frontPageStyle]}>\n                        {renderPage(page.left)}\n                    </Animated.View>\n                )}\n            </Animated.View>\n        </View>\n    );\n};\n\nexport { BookPagePortrait };\n\nconst styles = StyleSheet.create({\n    container: {\n        flex: 1,\n    },\n    pageContainer: {\n        height: '100%',\n        width: '100%',\n        position: 'absolute',\n        backfaceVisibility: 'hidden',\n        overflow: 'hidden',\n        backgroundColor: 'white',\n    },\n});\n"],"mappings":"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"}